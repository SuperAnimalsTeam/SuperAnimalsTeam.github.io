<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon" href="8.ico">
    <title>SuperAnimalsTeam加密/解密</title>
</head>
<body bgcolor="#90EE90">
<img src="8.ico" alt="SuperAnimalsTeam"></img><br>
SuperAnimalsTeam 加密解密
<p id="p1" hidden="hidden">
    源:
    <input id="A" style="width:1000px"></input><br>
    结果:
    <input id="B" style="width:1000px"></input><br>
    密钥（不一定必要）:
    <input id="C" style="width:1000px"></input><br>
    <button onclick="A()">生成随机密钥</button><br>
    <button onclick="jm()">加密</button>
    <button onclick="jjm()">解密</button><br>
    <button onclick="jmcbc()">加密2</button>
    <button onclick="jjmcbc()">解密2</button><br>
    <button onclick="jmecb()">加密3</button>
    <button onclick="jjmecb()">解密3</button><br>
</p>
<p id="p2" >用户名:<input id="usrn" style="width:1000px"></input></p>
<p id="p3">密码:<input id="pswd" type="password" style="width:1000px"></input></p>
<p id="p4" ></p>
<p id="p5" hidden="hidden"><button id="bk" onclick="bk()">返回</button></p>

<p id="dbg" hidden="hidden"><button id="dbg1" onclick="s()">dbg1</button></p>

<button onclick="lgin()" id="blg">登录</button>
<button onclick="qzgly()" id="bq">群主/管理员登录</button>
<button onclick="sup()" id="bsu2" hidden="hidden">输入用户名后确定</button>
<button onclick="psup()" id="bsu">还无账号？去注册</button>
<button onclick="osu()" id="bsu3" hidden="hidden">请查看您的密码，然后点击此按钮</button>
<script src="base64.js"></script>
<script type="text/javascript">
    function jm(){
        var a = document.getElementById("A").value;
        document.getElementById("B").value=window.btoa(unescape(encodeURIComponent(a)));
    }
    function jjm(){
        var a = document.getElementById("A").value;
        document.getElementById("B").value=decodeURIComponent(escape(window.atob(a)));
    }
</script>
<script src="crypto-js.js"></script>
<script>
    function s(){
        /**var request = indexedDB.open("satt", 1);
         var db = event.target.result;
         var objectStore = db.createObjectStore("uap", { keyPath: 'id' });

         // 创建索引
         objectStore.createIndex("fieldName", "fieldName", { unique: false });
         var transaction = db.transaction("uap", 'readwrite');
         objectStore = transaction.objectStore("uap");

         // 插入数据
         objectStore.add({ id: 1, name: 'John Doe', age: 30 });*/
            // 打开或创建一个数据库
        var request = indexedDB.open("sutest", 1);

// 处理数据库升级
        request.onupgradeneeded = function(event) {
            var db = event.target.result;

            // 创建对象存储（表）并设置主键
            //var objectStore = db.createObjectStore("uap", { keyPath: 'id' });

            // 创建索引
            //objectStore.createIndex("fieldName", "fieldName", { unique: false });
        };

// 数据库打开成功时的回调
        request.onsuccess = function(event) {
            var db = event.target.result;

            // 进行事务操作
            var transaction = db.transaction("uap", 'readwrite');
            var objectStore = transaction.objectStore("uap");

            // 插入数据
            //objectStore.add({ id: "a", name: 'John Doe', age: 30 });

            // 查询数据 db.objectStoreNames.contains("a")
            var query = objectStore.get(1);
            query.onsuccess = function(event) {
                console.log(event.target.result.age);
                // var db = event.target.result;

                //console.log(db.objectStoreNames.contains("a"));

            };
        };

// 错误处理
        request.onerror = function(event) {
            console.error('Database error:', event.target.error);
        };
    }

</script>
<script>
    function MD5(text){
        var hash = CryptoJS.MD5(text);
        var hash1 = CryptoJS.MD5(hash);
        var hash2 = CryptoJS.MD5(hash1);
        var hash3 = CryptoJS.MD5(hash2);
        var hash4 = CryptoJS.MD5(hash3);
        var hash5 = CryptoJS.MD5(hash4);
        var hash6 = CryptoJS.MD5(hash5);
        return hash6;
    }
    function bk(){
        document.getElementById("bq").hidden=!true;
        document.getElementById("p1").hidden = !false;
        document.getElementById("p2").hidden = !true;
        document.getElementById("p3").hidden = !true;
        document.getElementById("blg").hidden = !true;
        document.getElementById("bsu").hidden = !true;
        document.getElementById("bk").hidden = true;
        document.getElementById("usrn").value = "";
        document.getElementById("pswd").value = "";
    }
    function qzgly(){
        var a=document.getElementById("pswd").value;
        if(MD5(a)=="aa69d9961802cf3e09f45a55d06146d0"){
            document.getElementById("dbg").hidden=false;
            document.getElementById("p1").hidden = false;
            document.getElementById("p5").hidden = false;
        }
        if(MD5(a)=="1b04b02d9e93760c5fd74a4f80c65b03"){
            document.getElementById("bq").hidden=true;
            document.getElementById("p1").hidden = false;
            document.getElementById("p2").hidden = true;
            document.getElementById("p3").hidden = true;
            document.getElementById("blg").hidden = true;
            document.getElementById("bsu").hidden = true;
            document.getElementById("p5").hidden = false;
        }
    }
    function ACE(text, secretKey) {
        var keyHex = CryptoJS.enc.Base64.parse(secretKey);
        var ivHex = keyHex.clone();
        ivHex.sigBytes = 16;
        ivHex.words.splice(4);
        var messageHex = CryptoJS.enc.Utf8.parse(text);
        var encrypted = CryptoJS.AES.encrypt(messageHex, keyHex, {
            "iv": ivHex,
            "mode": CryptoJS.mode.CBC,
            "padding": CryptoJS.pad.Pkcs7
        });
        return encrypted.toString();
    }
    function ACD(textBase64, secretKey) {
        var keyHex = CryptoJS.enc.Base64.parse(secretKey);
        var ivHex = keyHex.clone();
        ivHex.sigBytes = 16;
        ivHex.words.splice(4);
        var decrypt = CryptoJS.AES.decrypt(textBase64, keyHex, {
            "iv": ivHex,
            "mode": CryptoJS.mode.CBC,
            "padding": CryptoJS.pad.Pkcs7
        });
        return CryptoJS.enc.Utf8.stringify(decrypt);
    }
    function rString(length) {
        var result = '';
        var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
        var charactersLength = characters.length;
        for (var i = 0; i < length; i++) {
            result += characters.charAt(Math.floor(Math.random() * charactersLength));
        }
        return result;
    }
    function AEE(text, secretKey) {
        var keyHex = CryptoJS.enc.Base64.parse(secretKey);
        var messageHex = CryptoJS.enc.Utf8.parse(text);
        var encrypted = CryptoJS.AES.encrypt(messageHex, keyHex, {
            "mode": CryptoJS.mode.ECB,
            "padding": CryptoJS.pad.Pkcs7
        });
        return encrypted.toString();
    }
    function AED(textBase64, secretKey) {
        var keyHex = CryptoJS.enc.Base64.parse(secretKey);
        var decrypt = CryptoJS.AES.decrypt(textBase64, keyHex, {
            "mode": CryptoJS.mode.ECB,
            "padding": CryptoJS.pad.Pkcs7
        });
        return CryptoJS.enc.Utf8.stringify(decrypt);
    }
    function jmcbc(){
        var a = document.getElementById("A").value;
        var c=document.getElementById("C").value;
        document.getElementById("B").value=ACE(a,c);
    }
    function jjmcbc(){
        var a = document.getElementById("A").value;
        var c=document.getElementById("C").value;
        document.getElementById("B").value=ACD(a,c);
    }
    function jmecb(){
        var a = document.getElementById("A").value;
        var c=document.getElementById("C").value;
        document.getElementById("B").value=AEE(a,c);
    }
    function jjmecb(){
        var a = document.getElementById("A").value;
        var c=document.getElementById("C").value;
        document.getElementById("B").value=AED(a,c);
    }
    function A(){
        document.getElementById("C").value=rString(43);
    }
    function lgin(){
        var a=document.getElementById("usrn").value;
        var b=AEE(ACE(window.btoa(unescape(encodeURIComponent(a))),"24l6tS0JpNDl7jq5RcYc8nkVBRFRxfTf5LxhVrwJF6j"),"rYeIQ8Crp3eHfeiWoo4IxjVPIjYAMPRyFYpAPXaCkGS");
        if(a.length==0){
            alert("请输入用户名!");
            return;
        }
        if(b.length==0){
            alert("请输入密码!");
            return;
        }
        if(document.getElementById("pswd").value==b){
            document.getElementById("p5").hidden = false;
            document.getElementById("bq").hidden=true;
            document.getElementById("p1").hidden = false;
            document.getElementById("p2").hidden = true;
            document.getElementById("p3").hidden = true;
            document.getElementById("blg").hidden = true;
            document.getElementById("bsu").hidden = true;}
        else {
            alert("密码或用户名错误！");
            document.getElementById("pswd").value = "";
            return;
        }
    }
    function psup(){
        document.getElementById("p3").hidden = true;
        document.getElementById("blg").hidden = true;
        document.getElementById("bsu").hidden = true;
        document.getElementById("bsu2").hidden = false;
        document.getElementById("bq").hidden=true;
    }
    function sup(){
        var a=document.getElementById("usrn").value;
        if(a.length==0){
            alert("请输入用户名!");
            return;
        }
        var b=AEE(ACE(window.btoa(unescape(encodeURIComponent(a))),"24l6tS0JpNDl7jq5RcYc8nkVBRFRxfTf5LxhVrwJF6j"),"rYeIQ8Crp3eHfeiWoo4IxjVPIjYAMPRyFYpAPXaCkGS");
        document.getElementById("p3").hidden = false;
        document.getElementById("pswd").value = b;
        document.getElementById("pswd").type="text";
        document.getElementById("bsu2").hidden = true;
        document.getElementById("bsu3").hidden = false;
    }
    function osu(){
        document.getElementById("pswd").value = "";
        document.getElementById("pswd").type="password";
        document.getElementById("blg").hidden = false;
        document.getElementById("bsu").hidden = false;
        document.getElementById("bsu2").hidden = true;
        document.getElementById("bsu3").hidden = true;
        document.getElementById("p4").hidden = true;
        document.getElementById("bq").hidden=false;
    }
</script>
</body>
</html>